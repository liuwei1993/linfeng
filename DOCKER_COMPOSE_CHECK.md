# Docker Compose é…ç½®æ£€æŸ¥æŠ¥å‘Š

**æ£€æŸ¥æ—¥æœŸ**: 2026-02-05  
**é…ç½®æ–‡ä»¶**: docs/docker-compose.yml  
**Docker Version**: éœ€è¦ Docker 20.10+, Docker Compose 1.29+

---

## âœ… å®Œæ•´æ€§æ£€æŸ¥

### 1ï¸âƒ£ é…ç½®æ–‡ä»¶åŸºç¡€ç»“æ„

```
âœ… Version: '3.8'               - ç°ä»£ç‰ˆæœ¬ï¼Œå®Œå…¨å…¼å®¹
âœ… Services: 7 ä¸ªæœåŠ¡           - è¦†ç›–æ‰€æœ‰å¿…è¦ç»„ä»¶
âœ… Networks: 1 ä¸ªè‡ªå®šä¹‰ç½‘ç»œ      - éš”ç¦»å’Œé€šä¿¡
âœ… Volumes: 5 ä¸ªæ•°æ®å·          - æ•°æ®æŒä¹…åŒ–
```

### 2ï¸âƒ£ æ ¸å¿ƒæœåŠ¡å®Œæ•´æ€§æ£€æŸ¥

| æœåŠ¡ | é•œåƒ | ç«¯å£ | å¥åº·æ£€æŸ¥ | ä¾èµ– | å®Œæ•´åº¦ |
|------|------|------|---------|------|--------|
| **app** | æœ¬åœ°æ„å»º âš ï¸ | 8080 | âœ… | MySQL/Redis/RabbitMQ | âœ… 100% |
| **mysql** | mysql:8.0-debian | 3306 | âœ… | - | âœ… 100% |
| **redis** | redis:7-alpine | 6379 | âœ… | - | âœ… 100% |
| **rabbitmq** | rabbitmq:3.12-mgmt | 5672 | âœ… | - | âœ… 100% |
| **nginx** | nginx:alpine | 80/443 | âœ… | app | âš ï¸ éœ€é…ç½® |
| **adminer** | adminer:latest | 8081 | âŒ | mysql | âœ… 100% |
| **minio** | minio/minio:latest | 9000/9001 | âœ… | - | âœ… 100% |

---

## âš ï¸ å‘ç°çš„é—®é¢˜

### é—®é¢˜ 1ï¸âƒ£: **app æœåŠ¡ä¾èµ– Dockerfile**

```yaml
app:
  build:
    context: .
    dockerfile: Dockerfile        # âš ï¸ éœ€è¦åœ¨é¡¹ç›®æ ¹ç›®å½•
```

**å½“å‰çŠ¶æ€**: Dockerfile å·²ç§»è‡³ `docs/Dockerfile`  
**å½±å“**: âŒ æ„å»ºä¼šå¤±è´¥

**è§£å†³æ–¹æ¡ˆ**:
```yaml
# æ–¹æ¡ˆ A: ä¿®æ”¹è·¯å¾„
build:
  context: .
  dockerfile: docs/Dockerfile

# æ–¹æ¡ˆ B: å¤åˆ¶å›æ ¹ç›®å½• (ä¸æ¨è)
cp docs/Dockerfile ./
```

---

### é—®é¢˜ 2ï¸âƒ£: **nginx.conf è·¯å¾„é”™è¯¯**

```yaml
nginx:
  volumes:
    - ./nginx.conf:/etc/nginx/nginx.conf:ro  # âš ï¸ è·¯å¾„é”™è¯¯
```

**å½“å‰çŠ¶æ€**: nginx.conf åœ¨ `docs/nginx.conf`  
**å½±å“**: âš ï¸ Nginx æœåŠ¡ä¼šå¯åŠ¨å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**:
```yaml
volumes:
  - ./docs/nginx.conf:/etc/nginx/nginx.conf:ro
```

---

### é—®é¢˜ 3ï¸âƒ£: **ç¼ºå°‘ SQL åˆå§‹åŒ–è„šæœ¬**

```yaml
mysql:
  volumes:
    # - ./sql:/docker-entrypoint-initdb.d  # âš ï¸ æ³¨é‡ŠçŠ¶æ€
```

**å½“å‰çŠ¶æ€**: SQL è„šæœ¬æœªæä¾›  
**å½±å“**: âš ï¸ æ•°æ®åº“æ²¡æœ‰è¡¨å’Œåˆå§‹æ•°æ®ï¼Œæ— æ³•æ­£å¸¸ä½¿ç”¨

**è§£å†³æ–¹æ¡ˆ**:
1. ä» QQ ç¾¤è·å– SQL è„šæœ¬
2. åˆ›å»º `sql/` ç›®å½•
3. æ”¾å…¥ SQL æ–‡ä»¶
4. å–æ¶ˆæ³¨é‡Šä¸Šè¿°é…ç½®

---

### é—®é¢˜ 4ï¸âƒ£: **å¥åº·æ£€æŸ¥ç¼ºå¤±**

```yaml
adminer:
  healthcheck: âŒ æ²¡æœ‰é…ç½®
```

**å½±å“**: ä½ - å¯é€‰åŠŸèƒ½

---

## ğŸ“‹ å¯ç›´æ¥è¿è¡Œçš„å‰ç½®æ¡ä»¶

| æ¡ä»¶ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| Docker å·²å®‰è£… | éœ€è¦ | docker -v æ£€æŸ¥ |
| Docker Compose å·²å®‰è£… | éœ€è¦ | docker-compose -v æ£€æŸ¥ |
| Dockerfile å¯è®¿é—® | âŒ éœ€è¦ä¿®æ”¹ | å½“å‰åœ¨ docs/ |
| nginx.conf å¯è®¿é—® | âŒ éœ€è¦ä¿®æ”¹ | å½“å‰åœ¨ docs/ |
| SQL è„šæœ¬å¯ç”¨ | âŒ éœ€è¦è·å– | ä» QQ ç¾¤è·å– |
| ç«¯å£æœªè¢«å ç”¨ | éœ€è¦æ£€æŸ¥ | 8080, 3306, 5672, 6379 ç­‰ |

**ç»“è®º**: âŒ **ä¸èƒ½ç›´æ¥è¿è¡Œï¼Œéœ€è¦åš 3 å¤„ä¿®æ”¹**

---

## ğŸ”§ ä¿®å¤æ–¹æ¡ˆ

### å¿«é€Ÿä¿®å¤ (5 åˆ†é’Ÿ)

#### æ–¹æ¡ˆ 1: ä¿®æ”¹ docker-compose.yml (æ¨è)

1. **ä¿®æ”¹ Dockerfile è·¯å¾„**:
```yaml
app:
  build:
    context: .
    dockerfile: docs/Dockerfile    # æ”¹è¿™é‡Œ
```

2. **ä¿®æ”¹ nginx.conf è·¯å¾„**:
```yaml
nginx:
  volumes:
    - ./docs/nginx.conf:/etc/nginx/nginx.conf:ro    # æ”¹è¿™é‡Œ
```

3. **è·å–å¹¶é…ç½® SQL è„šæœ¬**:
```bash
# 1. ä» QQ ç¾¤è·å– linfeng-love.sql
# 2. åˆ›å»ºç›®å½•
mkdir -p sql

# 3. æ”¾å…¥è„šæœ¬
cp linfeng-love.sql sql/

# 4. å–æ¶ˆæ³¨é‡Šé…ç½®
# - ./sql:/docker-entrypoint-initdb.d
```

---

## ğŸ“ ä¿®å¤åçš„ docker-compose.yml

æˆ‘æ¥ç”Ÿæˆä¿®å¤åçš„å®Œæ•´ç‰ˆæœ¬ï¼š

